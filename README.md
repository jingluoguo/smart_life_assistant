# Smart Life Assistant æ™ºèƒ½ç”Ÿæ´»åŠ©æ‰‹

<div align="center">

![Flutter](https://img.shields.io/badge/Flutter-3.7.2+-02569B?style=for-the-badge&logo=flutter)
![Dart](https://img.shields.io/badge/Dart-3.7.2+-0175C2?style=for-the-badge&logo=dart)
![License](https://img.shields.io/badge/License-MIT-green?style=for-the-badge)

ä¸€ä¸ªåŸºäº Flutter å¼€å‘çš„æ™ºèƒ½ç”Ÿæ´»åŠ©æ‰‹åº”ç”¨ï¼Œé›†æˆé˜¿é‡Œäº‘é€šä¹‰åƒé—®å¤§æ¨¡å‹ Function Calling èƒ½åŠ›ï¼Œä¸ºç”¨æˆ·æä¾›å¤©æ°”æŸ¥è¯¢ã€æŠ–éŸ³è§†é¢‘è§£æç­‰æ™ºèƒ½æœåŠ¡ã€‚

[ç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§) â€¢ [æ¶æ„](#ï¸-æŠ€æœ¯æ¶æ„) â€¢ [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢ [ä½¿ç”¨æŒ‡å—](#-ä½¿ç”¨æŒ‡å—) â€¢ [å¼€å‘æ–‡æ¡£](#-å¼€å‘æ–‡æ¡£)

</div>

---

## ğŸ“± é¡¹ç›®ç®€ä»‹

Smart Life Assistant æ˜¯ä¸€ä¸ªåŸºäº AI é©±åŠ¨çš„æ™ºèƒ½åŠ©æ‰‹åº”ç”¨ï¼Œé€šè¿‡é›†æˆå¤§è¯­è¨€æ¨¡å‹å’Œå®ç”¨åŠŸèƒ½æ¨¡å—ï¼Œå®ç°è‡ªç„¶è¯­è¨€äº¤äº’çš„ç”Ÿæ´»æœåŠ¡ã€‚åº”ç”¨é‡‡ç”¨ **Function Calling** æŠ€æœ¯ï¼Œèƒ½å¤Ÿæ™ºèƒ½è¯†åˆ«ç”¨æˆ·æ„å›¾å¹¶è‡ªåŠ¨è°ƒç”¨ç›¸åº”çš„åŠŸèƒ½æœåŠ¡ã€‚

### ğŸ¯ è®¾è®¡ç†å¿µ

- **AI é©±åŠ¨**ï¼šåŸºäºé€šä¹‰åƒé—®å¤§æ¨¡å‹çš„æ™ºèƒ½æ„å›¾è¯†åˆ«
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šåŠŸèƒ½æ¨¡å—æ¾è€¦åˆï¼Œæ˜“äºæ‰©å±•
- **è·¨å¹³å°æ”¯æŒ**ï¼šä¸€å¥—ä»£ç ï¼Œå¤šç«¯è¿è¡Œ
- **æœ€ä½³å®è·µ**ï¼šéµå¾ª Flutter å’Œ Dart å¼€å‘è§„èŒƒ

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸŒ¤ï¸ å¤©æ°”æŸ¥è¯¢åŠŸèƒ½

åŸºäºå’Œé£å¤©æ°” APIï¼Œæä¾›å…¨æ–¹ä½çš„å¤©æ°”ä¿¡æ¯æŸ¥è¯¢æœåŠ¡ï¼š

- **å®æ—¶å¤©æ°”**ï¼šæ ¹æ®ç»çº¬åº¦è·å–å½“å‰å®æ—¶å¤©æ°”ä¿¡æ¯
- **é€å°æ—¶é¢„æŠ¥**ï¼šæ”¯æŒ 24h / 72h / 168h é€å°æ—¶å¤©æ°”é¢„æŠ¥
- **é€å¤©é¢„æŠ¥**ï¼šæ”¯æŒ 3d / 7d / 10d / 15d / 30d å¤©æ°”é¢„æŠ¥
- **JWT è®¤è¯**ï¼šé‡‡ç”¨ EdDSA ç®—æ³•çš„å®‰å…¨è®¤è¯æœºåˆ¶
- **æ™ºèƒ½è§£æ**ï¼šè‡ªç„¶è¯­è¨€è¾“å…¥ï¼Œè‡ªåŠ¨è¯†åˆ«åœ°ç†ä½ç½®éœ€æ±‚

### ğŸ“¹ æŠ–éŸ³è§†é¢‘è§£æ

å¼ºå¤§çš„æŠ–éŸ³è§†é¢‘è§£æèƒ½åŠ›ï¼š

- **åˆ†äº«é“¾æ¥è§£æ**ï¼šæ™ºèƒ½è¯†åˆ«æŠ–éŸ³åˆ†äº«æ–‡æœ¬ä¸­çš„é“¾æ¥
- **æ— æ°´å°ä¸‹è½½**ï¼šè·å–é«˜æ¸…æ— æ°´å°è§†é¢‘ä¸‹è½½åœ°å€
- **è§†é¢‘ä¿¡æ¯æå–**ï¼šè‡ªåŠ¨æå–è§†é¢‘æ ‡é¢˜ã€IDã€æè¿°ç­‰å…ƒæ•°æ®
- **è‡ªåŠ¨å¤„ç†**ï¼šå¤„ç†æ–‡ä»¶åéæ³•å­—ç¬¦ï¼Œç¡®ä¿å¯ç”¨æ€§

### ğŸ¤– AI Function Calling

æ ¸å¿ƒ AI äº¤äº’èƒ½åŠ›ï¼š

- **å¤§æ¨¡å‹é›†æˆ**ï¼šé€šä¹‰åƒé—® qwen3-max æ¨¡å‹
- **æ„å›¾è¯†åˆ«**ï¼šè‡ªåŠ¨ç†è§£ç”¨æˆ·è‡ªç„¶è¯­è¨€è¾“å…¥
- **å‡½æ•°è°ƒç”¨**ï¼šæ™ºèƒ½é€‰æ‹©å¹¶æ‰§è¡Œç›¸åº”åŠŸèƒ½
- **ä¸Šä¸‹æ–‡ç®¡ç†**ï¼šæ”¯æŒå¤šè½®å¯¹è¯å’Œç»“æœåé¦ˆ

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Flutter | 3.7.2+ | è·¨å¹³å° UI æ¡†æ¶ |
| Dart | 3.7.2+ | ç¼–ç¨‹è¯­è¨€ |
| GetX | 4.6.6 | çŠ¶æ€ç®¡ç†å’Œè·¯ç”± |
| Dio | 5.2.1+ | ç½‘ç»œè¯·æ±‚åº“ |
| HTTP | 1.5.0 | HTTP å®¢æˆ·ç«¯ |
| dart_jsonwebtoken | 2.17.0 | JWT è®¤è¯ |
| cryptography | 2.7.0 | åŠ å¯†ç®—æ³•æ”¯æŒ |

### é¡¹ç›®ç»“æ„

```
smart_life_assistant/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ main.dart                          # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ app_config.dart               # å…¨å±€é…ç½®ï¼ˆAPI å¯†é’¥ã€URL ç­‰ï¼‰
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”‚   â””â”€â”€ dio_util.dart             # Dio ç½‘ç»œè¯·æ±‚å·¥å…·ç±»
â”‚   â”‚   â”œâ”€â”€ function_calling/
â”‚   â”‚   â”‚   â”œâ”€â”€ weather_function.dart     # å¤©æ°”åŠŸèƒ½æ¨¡å—
â”‚   â”‚   â”‚   â””â”€â”€ tiktok_function.dart      # æŠ–éŸ³è§£æåŠŸèƒ½æ¨¡å—
â”‚   â”‚   â””â”€â”€ service/
â”‚   â”‚       â””â”€â”€ function_call_service.dart # Function Calling æœåŠ¡
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ logger.dart                    # æ—¥å¿—å·¥å…·ç±»
â”œâ”€â”€ android/                                # Android å¹³å°ä»£ç 
â”œâ”€â”€ ios/                                    # iOS å¹³å°ä»£ç 
â”œâ”€â”€ web/                                    # Web å¹³å°ä»£ç 
â”œâ”€â”€ linux/                                  # Linux å¹³å°ä»£ç 
â”œâ”€â”€ macos/                                  # macOS å¹³å°ä»£ç 
â”œâ”€â”€ windows/                                # Windows å¹³å°ä»£ç 
â”œâ”€â”€ test/                                   # æµ‹è¯•ä»£ç 
â”œâ”€â”€ pubspec.yaml                            # ä¾èµ–é…ç½®
â””â”€â”€ README.md                               # é¡¹ç›®æ–‡æ¡£
```

### æ¶æ„è®¾è®¡

```mermaid
graph TB
    A[ç”¨æˆ·è¾“å…¥] --> B[FunctionCallService]
    B --> C[é€šä¹‰åƒé—®å¤§æ¨¡å‹]
    C --> D{è¯†åˆ«æ„å›¾}
    D -->|å¤©æ°”æŸ¥è¯¢| E[WeatherFunction]
    D -->|è§†é¢‘è§£æ| F[TikTokFunction]
    E --> G[å’Œé£å¤©æ°” API]
    F --> H[æŠ–éŸ³è§£ææœåŠ¡]
    G --> I[è¿”å›ç»“æœ]
    H --> I
    I --> C
    C --> J[AI å¤„ç†ç»“æœ]
    J --> K[å±•ç¤ºç»™ç”¨æˆ·]
```

### æ ¸å¿ƒæ¨¡å—è¯´æ˜

#### 1. AppConfig - é…ç½®ç®¡ç†

é›†ä¸­ç®¡ç†åº”ç”¨é…ç½®ä¿¡æ¯ï¼Œé‡‡ç”¨**ç§æœ‰æ„é€ å‡½æ•°**é˜²æ­¢å®ä¾‹åŒ–ï¼š

- å’Œé£å¤©æ°” API é…ç½®ï¼ˆHostã€Project IDã€Credential IDã€ç§é’¥ï¼‰
- é€šä¹‰åƒé—® API é…ç½®ï¼ˆURLã€API Keyã€æ¨¡å‹åç§°ï¼‰
- ç½‘ç»œè¶…æ—¶é…ç½®ï¼ˆè¿æ¥ã€æ¥æ”¶ã€å‘é€è¶…æ—¶æ—¶é—´ï¼‰
- æŠ–éŸ³è¯·æ±‚é…ç½®ï¼ˆUser-Agentã€åˆ†äº«åŸŸåï¼‰

#### 2. DioUtil - ç½‘ç»œè¯·æ±‚å·¥å…·

åŸºäº Dio çš„ç½‘ç»œè¯·æ±‚å°è£…ï¼Œæä¾›ç»Ÿä¸€çš„ç½‘ç»œè¯·æ±‚èƒ½åŠ›ï¼š

- **å•ä¾‹æ¨¡å¼**ï¼šå…¨å±€å”¯ä¸€å®ä¾‹
- **è¶…æ—¶é…ç½®**ï¼šè‡ªåŠ¨åº”ç”¨é…ç½®çš„è¶…æ—¶æ—¶é—´
- **è¯·æ±‚æ‹¦æˆªå™¨**ï¼šè‡ªåŠ¨è®°å½•è¯·æ±‚æ—¥å¿—
- **å“åº”æ‹¦æˆªå™¨**ï¼šè‡ªåŠ¨è®°å½•å“åº”æ—¥å¿—
- **é”™è¯¯æ‹¦æˆªå™¨**ï¼šç»Ÿä¸€é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- **å–æ¶ˆä»¤ç‰Œ**ï¼šæ”¯æŒè¯·æ±‚å–æ¶ˆ

#### 3. FunctionCallService - Function Calling æœåŠ¡

æ ¸å¿ƒæœåŠ¡ï¼Œè´Ÿè´£ä¸é€šä¹‰åƒé—®å¤§æ¨¡å‹äº¤äº’ï¼š

- **å·¥å…·æ³¨å†Œ**ï¼šé›†æˆæ‰€æœ‰åŠŸèƒ½æ¨¡å—çš„å·¥å…·å®šä¹‰
- **æ„å›¾è¯†åˆ«**ï¼šè°ƒç”¨å¤§æ¨¡å‹ç†è§£ç”¨æˆ·è¾“å…¥
- **å‡½æ•°è·¯ç”±**ï¼šæ ¹æ®æ¨¡å‹è¿”å›çš„å‡½æ•°åè°ƒç”¨å¯¹åº”åŠŸèƒ½
- **ç»“æœå¤„ç†**ï¼šå°†åŠŸèƒ½æ‰§è¡Œç»“æœè¿”å›ç»™æ¨¡å‹è¿›è¡ŒäºŒæ¬¡å¤„ç†
- **ä¸Šä¸‹æ–‡ç®¡ç†**ï¼šç»´æŠ¤å¯¹è¯å†å²

#### 4. WeatherFunction - å¤©æ°”æŸ¥è¯¢æ¨¡å—

æä¾›å¤©æ°”æŸ¥è¯¢ç›¸å…³åŠŸèƒ½ï¼š

- **JWT Token ç”Ÿæˆ**ï¼šä½¿ç”¨ EdDSA ç®—æ³•ç”Ÿæˆå’Œé£å¤©æ°” API è®¤è¯ä»¤ç‰Œ
- **å®æ—¶å¤©æ°”**ï¼š`getRealTimeWeatherInfo(lng, lat)`
- **é€å°æ—¶é¢„æŠ¥**ï¼š`getNextHoursWeatherInfo(lng, lat, hours)`
- **é€å¤©é¢„æŠ¥**ï¼š`getEveryDayWeatherInfo(lng, lat, days)`
- **å·¥å…·å®šä¹‰**ï¼šæä¾›ç»™å¤§æ¨¡å‹çš„å‡½æ•°æè¿°

#### 5. TikTokFunction - æŠ–éŸ³è§†é¢‘è§£ææ¨¡å—

æä¾›æŠ–éŸ³è§†é¢‘è§£æåŠŸèƒ½ï¼š

- **URL æå–**ï¼šä»åˆ†äº«æ–‡æœ¬ä¸­æå–é“¾æ¥
- **é‡å®šå‘å¤„ç†**ï¼šè·å–çœŸå®çš„è§†é¢‘ ID
- **é¡µé¢è§£æ**ï¼šè§£æè§†é¢‘é¡µé¢è·å–å…ƒæ•°æ®
- **æ— æ°´å°é“¾æ¥**ï¼šæ›¿æ¢æ°´å° URL ä¸ºæ— æ°´å°é“¾æ¥
- **ä¿¡æ¯æå–**ï¼šè¿”å›è§†é¢‘ URLã€æ ‡é¢˜ã€ID

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

ç¡®ä¿ä½ çš„å¼€å‘ç¯å¢ƒæ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š

| å·¥å…· | ç‰ˆæœ¬è¦æ±‚ | è¯´æ˜ |
|------|---------|------|
| Flutter SDK | â‰¥ 3.7.2 | [å®‰è£…æŒ‡å—](https://flutter.dev/docs/get-started/install) |
| Dart SDK | â‰¥ 3.7.2 | éš Flutter è‡ªåŠ¨å®‰è£… |
| IDE | ä»»æ„ | Android Studio / VS Code / Qoder IDE |
| Xcode | æœ€æ–°ç‰ˆ | iOS å¼€å‘å¿…éœ€ï¼ˆä»… macOSï¼‰ |
| Android Studio | æœ€æ–°ç‰ˆ | Android å¼€å‘æ¨è |

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/yourusername/smart_life_assistant.git
cd smart_life_assistant
```

#### 2. å®‰è£…ä¾èµ–

```bash
flutter pub get
```

#### 3. é…ç½® API å¯†é’¥

ç¼–è¾‘ `lib/config/app_config.dart` æ–‡ä»¶ï¼Œé…ç½®ä½ çš„ API å¯†é’¥ï¼š

```dart
class AppConfig {
  AppConfig._();

  // ==================== å’Œé£å¤©æ°”é…ç½® ====================
  static const String qWeatherApiHost = 'your-api-host.qweatherapi.com';
  static const String qWeatherProjectId = 'YOUR_PROJECT_ID';
  static const String qWeatherCredentialId = 'YOUR_CREDENTIAL_ID';
  static const String qWeatherPrivateKey = '''
-----BEGIN PRIVATE KEY-----
YOUR_PRIVATE_KEY_HERE
-----END PRIVATE KEY-----
''';

  // ==================== é€šä¹‰åƒé—®é…ç½® ====================
  static const String dashScopeApiUrl =
      'https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions';
  static const String dashScopeApiKey = 'sk-YOUR_API_KEY_HERE';
  static const String dashScopeModel = 'qwen3-max';
}
```

**è·å– API å¯†é’¥ï¼š**

- **é€šä¹‰åƒé—® API Key**ï¼šè®¿é—® [é˜¿é‡Œäº‘ DashScope](https://dashscope.aliyun.com/) è·å–
- **å’Œé£å¤©æ°” API**ï¼šè®¿é—® [å’Œé£å¤©æ°”å¼€å‘å¹³å°](https://dev.qweather.com/) æ³¨å†Œå¹¶è·å–

#### 4. è¿è¡Œé¡¹ç›®

```bash
# æŸ¥çœ‹å¯ç”¨è®¾å¤‡
flutter devices

# è¿è¡Œåˆ° Android è®¾å¤‡/æ¨¡æ‹Ÿå™¨
flutter run

# è¿è¡Œåˆ° iOS è®¾å¤‡/æ¨¡æ‹Ÿå™¨ï¼ˆéœ€è¦ macOSï¼‰
flutter run -d ios

# è¿è¡Œåˆ° Web æµè§ˆå™¨
flutter run -d chrome

# è¿è¡Œåˆ°æ¡Œé¢ï¼ˆmacOS/Windows/Linuxï¼‰
flutter run -d macos
flutter run -d windows
flutter run -d linux
```

#### 5. æ„å»ºå‘å¸ƒç‰ˆæœ¬

```bash
# Android APK
flutter build apk --release

# Android App Bundle
flutter build appbundle --release

# iOS
flutter build ios --release

# Web
flutter build web --release
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### å¤©æ°”æŸ¥è¯¢ç¤ºä¾‹

ç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªç„¶è¯­è¨€æŸ¥è¯¢å¤©æ°”ï¼ŒAI ä¼šè‡ªåŠ¨è¯†åˆ«æ„å›¾å¹¶è°ƒç”¨ç›¸åº”åŠŸèƒ½ï¼š

```text
ç”¨æˆ·ï¼š"åŒ—äº¬ç°åœ¨çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"
åŠ©æ‰‹ï¼š[è‡ªåŠ¨è¯†åˆ«ä½ç½® â†’ è°ƒç”¨å®æ—¶å¤©æ°”æŸ¥è¯¢ â†’ è¿”å›å½“å‰å¤©æ°”ä¿¡æ¯]

ç”¨æˆ·ï¼š"ä¸Šæµ·æœªæ¥ 24 å°æ—¶çš„å¤©æ°”é¢„æŠ¥"
åŠ©æ‰‹ï¼š[è¯†åˆ«ä¸Šæµ·ç»çº¬åº¦ â†’ è°ƒç”¨é€å°æ—¶å¤©æ°”é¢„æŠ¥(24h) â†’ è¿”å›è¯¦ç»†é¢„æŠ¥]

ç”¨æˆ·ï¼š"æ·±åœ³æœªæ¥ 7 å¤©çš„å¤©æ°”æƒ…å†µ"
åŠ©æ‰‹ï¼š[è¯†åˆ«æ·±åœ³ç»çº¬åº¦ â†’ è°ƒç”¨é€å¤©å¤©æ°”é¢„æŠ¥(7d) â†’ è¿”å›æœªæ¥ 7 å¤©é¢„æŠ¥]
```

**æ”¯æŒçš„æŸ¥è¯¢ç±»å‹ï¼š**
- å®æ—¶å¤©æ°”æŸ¥è¯¢
- é€å°æ—¶é¢„æŠ¥ï¼š24h / 72h / 168h
- é€å¤©é¢„æŠ¥ï¼š3d / 7d / 10d / 15d / 30d

### æŠ–éŸ³è§†é¢‘è§£æç¤ºä¾‹

ç›´æ¥ç²˜è´´æŠ–éŸ³åˆ†äº«æ–‡æœ¬å³å¯ï¼š

```text
ç”¨æˆ·ï¼š"å¸®æˆ‘è·å–è¿™ä¸ªè§†é¢‘çš„ä¸‹è½½é“¾æ¥ 8.92 EUY:/ 07/06 G@v.fB è¿™ä¸ªè§†é¢‘ä¸é”™ğŸ‘å¤åˆ¶æ‰“å¼€æŠ–éŸ³æé€Ÿç‰ˆğŸ‘€ä»Šå¤©å¹äº†ä¸€ä¸ªè¶…çº§å®Œç¾çš„æ³¢æ³¢å¤´# å°å­¦ç”Ÿ# å¤„å¥³åº§  https://v.douyin.com/FmNeSgqBlac/"

åŠ©æ‰‹ï¼š[æå–é“¾æ¥ â†’ è§£æè§†é¢‘ä¿¡æ¯ â†’ è¿”å›æ— æ°´å°ä¸‹è½½åœ°å€]

è¿”å›ç»“æœï¼š
{
  "url": "æ— æ°´å°è§†é¢‘ä¸‹è½½åœ°å€",
  "title": "ä»Šå¤©å¹äº†ä¸€ä¸ªè¶…çº§å®Œç¾çš„æ³¢æ³¢å¤´",
  "video_id": "è§†é¢‘ID"
}
```

### æ ¸å¿ƒ API ä½¿ç”¨

#### Function Calling æœåŠ¡

```dart
import 'package:smart_life_assistant/data/service/function_call_service.dart';

// è°ƒç”¨ Function Calling æœåŠ¡
FunctionCallService.getInstance().handleFunctionCall(
  text: 'ç”¨æˆ·è¾“å…¥çš„è‡ªç„¶è¯­è¨€',
);
```

#### å¤©æ°”æŸ¥è¯¢

```dart
import 'package:smart_life_assistant/data/function_calling/weather_function.dart';

// è·å–å®æ—¶å¤©æ°”
String result = await WeatherFunction.getInstance()
  .getRealTimeWeatherInfo('116.41', '39.90'); // åŒ—äº¬ç»çº¬åº¦

// è·å–é€å°æ—¶å¤©æ°”é¢„æŠ¥
String hourly = await WeatherFunction.getInstance()
  .getNextHoursWeatherInfo('116.41', '39.90', '24h');

// è·å–é€å¤©å¤©æ°”é¢„æŠ¥
String daily = await WeatherFunction.getInstance()
  .getEveryDayWeatherInfo('116.41', '39.90', '7d');
```

#### æŠ–éŸ³è§†é¢‘è§£æ

```dart
import 'package:smart_life_assistant/data/function_calling/tiktok_function.dart';

// è§£ææŠ–éŸ³åˆ†äº«é“¾æ¥
Map<String, String> result = await TikTokFunction.getInstance()
  .parseTiktokShareUrl('åˆ†äº«æ–‡æœ¬å†…å®¹');

// ç»“æœåŒ…å«ï¼šurlï¼ˆè§†é¢‘åœ°å€ï¼‰ã€titleï¼ˆæ ‡é¢˜ï¼‰ã€video_idï¼ˆè§†é¢‘IDï¼‰
```

## ğŸ”§ å¼€å‘æ–‡æ¡£

### æ·»åŠ æ–°çš„åŠŸèƒ½æ¨¡å—

æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ·»åŠ æ–°çš„åŠŸèƒ½æ¨¡å—ï¼š

#### 1. åˆ›å»ºåŠŸèƒ½ç±»

åœ¨ `lib/data/function_calling/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„åŠŸèƒ½ç±»ï¼š

```dart
class YourFunction {
  static final YourFunction _instance = YourFunction._();
  
  YourFunction._();
  
  factory YourFunction.getInstance() {
    return _instance;
  }
  
  // å®šä¹‰å·¥å…·æè¿°
  final List<Map<String, dynamic>> yourTools = [
    {
      "type": "function",
      "function": {
        "name": "yourFunctionName",
        "description": "åŠŸèƒ½æè¿°ï¼Œç”¨äºå¸®åŠ© AI ç†è§£ä½•æ—¶è°ƒç”¨æ­¤åŠŸèƒ½",
        "parameters": {
          "type": "object",
          "properties": {
            "param1": {
              "type": "string",
              "description": "å‚æ•°1çš„æè¿°"
            },
            "param2": {
              "type": "integer",
              "description": "å‚æ•°2çš„æè¿°",
              "enum": ["é€‰é¡¹1", "é€‰é¡¹2"] // å¯é€‰çš„æšä¸¾å€¼
            },
          },
        },
        "required": ["param1"], // å¿…éœ€å‚æ•°
      },
    },
  ];
  
  // å®ç°å…·ä½“åŠŸèƒ½
  Future<String> yourFunctionName(String param1, String param2) async {
    // åŠŸèƒ½å®ç°
    return 'æ‰§è¡Œç»“æœ';
  }
}
```

#### 2. æ³¨å†Œå·¥å…·

åœ¨ `FunctionCallService` ä¸­æ³¨å†Œå·¥å…·ï¼š

```dart
final List<Map<String, dynamic>> tools = [
  ...WeatherFunction.getInstance().weatherTools,
  ...TikTokFunction.getInstance().tiktokTools,
  ...YourFunction.getInstance().yourTools, // æ·»åŠ æ–°å·¥å…·
];
```

#### 3. æ·»åŠ å‡½æ•°è°ƒç”¨é€»è¾‘

åœ¨ `parseFunctionCall` æ–¹æ³•ä¸­æ·»åŠ å¤„ç†é€»è¾‘ï¼š

```dart
void parseFunctionCall(Map toolCall, List messages) async {
  var callName = toolCall['name'];
  Response? response;
  
  // ... ç°æœ‰ä»£ç  ...
  
  else if (callName == 'yourFunctionName') {
    var arguments = toolCall['arguments'];
    var args = jsonDecode(arguments);
    var content = await YourFunction.getInstance().yourFunctionName(
      args['param1'],
      args['param2'],
    );
    messages.add({'role': 'tool', 'content': content});
    response = await _commonDashScopeApiCall(messages);
  }
  
  // ...
}
```

### æœ€ä½³å®è·µ

#### 1. é…ç½®ç®¡ç†

æ‰€æœ‰é…ç½®ä¿¡æ¯åº”é›†ä¸­åœ¨ `AppConfig` ä¸­ç®¡ç†ï¼š

```dart
class AppConfig {
  AppConfig._(); // ç§æœ‰æ„é€ å‡½æ•°ï¼Œé˜²æ­¢å®ä¾‹åŒ–
  
  static const String yourApiKey = 'your-api-key';
  static const Duration yourTimeout = Duration(seconds: 30);
}
```

#### 2. ç½‘ç»œè¯·æ±‚

ä½¿ç”¨ `DioUtil` è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼š

```dart
import 'package:smart_life_assistant/data/core/dio_util.dart';

// GET è¯·æ±‚
Response response = await DioUtil.getInstance().get(
  'https://api.example.com/data',
  headers: {'Authorization': 'Bearer token'},
  queryParameters: {'key': 'value'},
);

// POST è¯·æ±‚
Response response = await DioUtil.getInstance().post(
  'https://api.example.com/data',
  data: {'key': 'value'},
  headers: {'Content-Type': 'application/json'},
);
```

#### 3. æ—¥å¿—è®°å½•

ä½¿ç”¨ `Logger` å·¥å…·ç±»è®°å½•æ—¥å¿—ï¼š

```dart
import 'package:smart_life_assistant/utils/logger.dart';

Logger.d('YourClass', 'Debug message');
Logger.i('YourClass', 'Info message');
Logger.w('YourClass', 'Warning message');
Logger.e('YourClass', 'Error message', error, stackTrace);
```

#### 4. å•ä¾‹æ¨¡å¼

åŠŸèƒ½ç±»åº”ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼š

```dart
class YourService {
  static final YourService _instance = YourService._();
  
  YourService._();
  
  factory YourService.getInstance() {
    return _instance;
  }
}
```

### ä»£ç è§„èŒƒ

é¡¹ç›®éµå¾ªä»¥ä¸‹ä»£ç è§„èŒƒï¼š

- **å‘½åè§„èŒƒ**ï¼š
  - ç±»åï¼šPascalCaseï¼ˆå¦‚ `WeatherFunction`ï¼‰
  - æ–¹æ³•åï¼šcamelCaseï¼ˆå¦‚ `getRealTimeWeatherInfo`ï¼‰
  - å¸¸é‡ï¼šlowerCamelCaseï¼ˆå¦‚ `dashScopeApiKey`ï¼‰
  - ç§æœ‰æˆå‘˜ï¼šä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼ˆå¦‚ `_instance`ï¼‰

- **æ–‡ä»¶ç»„ç»‡**ï¼š
  - ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªç±»
  - ç›¸å…³åŠŸèƒ½ç»„ç»‡åœ¨åŒä¸€ç›®å½•
  - ä½¿ç”¨ barrel æ–‡ä»¶å¯¼å‡ºå…¬å…± API

- **æ³¨é‡Šè§„èŒƒ**ï¼š
  - ç±»å’Œå…¬å…±æ–¹æ³•å¿…é¡»æœ‰æ–‡æ¡£æ³¨é‡Š
  - ä½¿ç”¨ `///` è¿›è¡Œæ–‡æ¡£æ³¨é‡Š
  - å¤æ‚é€»è¾‘æ·»åŠ è¡Œå†…æ³¨é‡Š

## ğŸ“¦ ä¾èµ–è¯´æ˜

### æ ¸å¿ƒä¾èµ–

| ä¾èµ–åŒ… | ç‰ˆæœ¬ | ç”¨é€” | è¯´æ˜ |
|--------|------|------|------|
| flutter | SDK | Flutter æ¡†æ¶ | è·¨å¹³å° UI æ¡†æ¶ |
| cupertino_icons | ^1.0.8 | iOS å›¾æ ‡ | iOS é£æ ¼å›¾æ ‡åº“ |
| get | ^4.6.6 | çŠ¶æ€ç®¡ç† | è½»é‡çº§çŠ¶æ€ç®¡ç†å’Œè·¯ç”± |
| dio | ^5.2.1+1 | ç½‘ç»œè¯·æ±‚ | å¼ºå¤§çš„ HTTP å®¢æˆ·ç«¯ |
| http | ^1.5.0 | HTTP è¯·æ±‚ | Dart å®˜æ–¹ HTTP åº“ |
| dart_jsonwebtoken | ^2.17.0 | JWT è®¤è¯ | JWT Token ç”Ÿæˆå’ŒéªŒè¯ |
| cryptography | ^2.7.0 | åŠ å¯†ç®—æ³• | æä¾› EdDSA ç­‰åŠ å¯†ç®—æ³• |

### å¼€å‘ä¾èµ–

| ä¾èµ–åŒ… | ç‰ˆæœ¬ | ç”¨é€” |
|--------|------|------|
| flutter_test | SDK | å•å…ƒæµ‹è¯• |
| flutter_lints | ^5.0.0 | ä»£ç æ£€æŸ¥ |

## ğŸŒ å¹³å°æ”¯æŒ

| å¹³å° | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| âœ… Android | å·²æ”¯æŒ | API 21+ (Android 5.0+) |
| âœ… iOS | å·²æ”¯æŒ | iOS 12.0+ |
| âœ… Web | å·²æ”¯æŒ | ç°ä»£æµè§ˆå™¨ |
| âœ… macOS | å·²æ”¯æŒ | macOS 10.14+ |
| âœ… Windows | å·²æ”¯æŒ | Windows 10+ |
| âœ… Linux | å·²æ”¯æŒ | Ubuntu 20.04+ |

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
flutter test

# è¿è¡ŒæŒ‡å®šæµ‹è¯•æ–‡ä»¶
flutter test test/widget_test.dart

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
flutter test --coverage
```

## ğŸ› å¸¸è§é—®é¢˜

### 1. JWT Token ç”Ÿæˆå¤±è´¥

**é—®é¢˜**ï¼šå’Œé£å¤©æ°” API è¿”å› 401 æœªæˆæƒ

**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥ `AppConfig` ä¸­çš„ç§é’¥æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿åŒ…å«å®Œæ•´çš„ PEM å¤´å°¾ã€‚

### 2. ç½‘ç»œè¯·æ±‚è¶…æ—¶

**é—®é¢˜**ï¼šè¯·æ±‚è¶…æ—¶é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œæˆ–åœ¨ `AppConfig` ä¸­è°ƒæ•´è¶…æ—¶æ—¶é—´ã€‚

### 3. æŠ–éŸ³è§†é¢‘è§£æå¤±è´¥

**é—®é¢˜**ï¼šæ— æ³•è§£æåˆ†äº«é“¾æ¥

**è§£å†³æ–¹æ¡ˆ**ï¼šæŠ–éŸ³é¡µé¢ç»“æ„å¯èƒ½å˜åŒ–ï¼Œéœ€è¦æ›´æ–°è§£æé€»è¾‘ã€‚

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-10-15)

- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… é›†æˆé€šä¹‰åƒé—® Function Calling
- âœ… å®ç°å¤©æ°”æŸ¥è¯¢åŠŸèƒ½
- âœ… å®ç°æŠ–éŸ³è§†é¢‘è§£æåŠŸèƒ½
- âœ… å®Œå–„ç½‘ç»œè¯·æ±‚å’Œæ—¥å¿—ç³»ç»Ÿ

## ğŸ—ºï¸ è·¯çº¿å›¾

- [ ] æ·»åŠ æ›´å¤šå¤©æ°”æ•°æ®ï¼ˆç©ºæ°”è´¨é‡ã€ç”Ÿæ´»æŒ‡æ•°ç­‰ï¼‰
- [ ] æ”¯æŒæ›´å¤šè§†é¢‘å¹³å°è§£æï¼ˆBç«™ã€YouTube ç­‰ï¼‰
- [ ] æ·»åŠ ç”¨æˆ·ç•Œé¢å’Œäº¤äº’ä¼˜åŒ–
- [ ] æ”¯æŒç¦»çº¿ç¼“å­˜
- [ ] æ·»åŠ å¤šè¯­è¨€æ”¯æŒ
- [ ] é›†æˆè¯­éŸ³äº¤äº’åŠŸèƒ½

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### è´¡çŒ®è€…

æ„Ÿè°¢æ‰€æœ‰ä¸ºæœ¬é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼

## ğŸ“® è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€ï¼š[GitHub](https://github.com/yourusername/smart_life_assistant)
- é—®é¢˜åé¦ˆï¼š[Issues](https://github.com/yourusername/smart_life_assistant/issues)
- è®¨è®ºäº¤æµï¼š[Discussions](https://github.com/yourusername/smart_life_assistant/discussions)

## ğŸ™ è‡´è°¢

- [Flutter](https://flutter.dev/) - ä¼˜ç§€çš„è·¨å¹³å°æ¡†æ¶
- [é˜¿é‡Œäº‘ DashScope](https://dashscope.aliyun.com/) - æä¾›é€šä¹‰åƒé—® API
- [å’Œé£å¤©æ°”](https://dev.qweather.com/) - æä¾›å¤©æ°”æ•°æ® API
- æ‰€æœ‰å¼€æºè´¡çŒ®è€…

## âš ï¸ å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ã€‚ä½¿ç”¨æœ¬é¡¹ç›®æ—¶ï¼Œè¯·éµå®ˆç›¸å…³ API æœåŠ¡æä¾›å•†çš„ä½¿ç”¨æ¡æ¬¾å’Œæ¡ä»¶ã€‚

---

<div align="center">

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª â­ï¸ Star æ”¯æŒä¸€ä¸‹ï¼**

Made with â¤ï¸ by Flutter developers

</div>
